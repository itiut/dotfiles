language: ruby
rvm:
  - 2.3
os:
  - osx
cache:
  bundler: true
  directories:
    - $(brew --cache)
  timeout: 86400
before_install:
  - bundle install
  - brew update
  - brew --version
  - brew list node && sed -e "/^brew 'homebrew\/versions\/node.*'$/d" -i .orig linked/.Brewfile
  - mkdir -pv
      $HOME/.aws
      $HOME/.config
      $HOME/.ssh
      $HOME/Dropbox/.share/.aws
      $HOME/Dropbox/.share/.config
      $HOME/Dropbox/.share/.ssh
      $HOME/Library/Application\ Support/Code/User
  - touch
      $HOME/Dropbox/.share/.aws/config
      $HOME/Dropbox/.share/.aws/credentials
      $HOME/Dropbox/.share/.config/hub
      $HOME/Dropbox/.share/.gist
      $HOME/Dropbox/.share/.gitconfig.local
      $HOME/Dropbox/.share/.ssh/config
      $HOME/Dropbox/.share/.wakatime.cfg
      $HOME/Dropbox/.share/.zshenv.local
install:
  - travis_retry make brew
  - make shell
  - yes | make symlink
script:
  - make test
  - /usr/local/bin/zsh -cli 'true'
